<form (ngSubmit)="onSubmit()">
  <div class="row">
    <!-- Image Upload Section -->
    <div class="col-lg-5">
      <div class="card h-100">
        <div class="card-body">
          <h5 class="mb-4">Imagen del Producto</h5>

          <!-- Image Upload Area -->
          <div class="image-upload-area" [class.has-image]="hasImage()" (dragover)="onDragOver($event)"
            (drop)="onDrop($event)" (click)="triggerFileInput(fileInput)">

            <input #fileInput type="file" accept="image/*" (change)="onFileSelected($event)" style="display: none;">

            <div class="upload-placeholder" *ngIf="!hasImage()">
              <i class="bi bi-cloud-upload upload-icon"></i>
              <p class="upload-text">Arrastra y suelta una imagen aquí</p>
              <p class="upload-subtext">o</p>
              <button type="button" class="btn btn-outline-primary"
                (click)="fileInput.click(); $event.stopPropagation()">
                Seleccionar Imagen
              </button>
            </div>

            <div class="image-preview-container" [class.active]="hasImage()">
              <img [src]="imagePreview()" alt="Preview" class="image-preview">
              <button type="button" class="btn btn-danger btn-sm remove-image-btn" (click)="removeImage($event)">
                <i class="bi bi-trash"></i> Eliminar
              </button>
            </div>
          </div>

          <small class="text-muted d-block mt-2">
            Formatos aceptados: JPG, PNG, GIF (Máx. 5MB)
          </small>
        </div>
      </div>
    </div>

    <!-- Product Details Section -->
    <div class="col-lg-7">
      <div class="card">
        <div class="card-body">
          <h5 class="mb-4">Información del Producto</h5>

          <!-- Category -->
          <div class="mb-3">
            <label for="category" class="form-label">Categoría *</label>
            <select class="form-select" id="category" name="category" [(ngModel)]="product.category" required>
              <option value="">Selecciona una categoría</option>
              <option *ngFor="let cat of categories" [value]="cat.categoria_id">
                {{ cat.nombre }}
              </option>
            </select>
          </div>

          <!-- Product Name -->
          <div class="mb-3">
            <label for="productName" class="form-label">Nombre del Producto *</label>
            <input type="text" class="form-control" id="productName" name="productName" [(ngModel)]="product.name"
              placeholder="Ej: Lápiz Grafito HB Faber-Castell" required>
          </div>

          <!-- Product Code -->
          <div class="mb-3">
            <label for="productCode" class="form-label">Codigo del Producto *</label>
            <input type="text" class="form-control" id="productCode" name="productCode"
              [(ngModel)]="product.codeProduct" placeholder="Ej: 4009900484039" required>
          </div>

          <!-- Price and Stock -->
          <div class="row">
            <div class="col-md-6 mb-3">
              <label for="price" class="form-label">Precio *</label>
              <div class="input-group">
                <span class="input-group-text">$</span>
                <input type="number" class="form-control" id="price" name="price" [(ngModel)]="product.price"
                  step="0.01" min="0" placeholder="299.99" required>
              </div>
            </div>

            <div class="col-md-6 mb-3">
              <label for="stock" class="form-label">Stock Disponible</label>
              <select class="form-select" id="stock" name="stock" [(ngModel)]="product.stock" required>
                <option value="">Seleccione stock</option>
                <option *ngFor="let cat of stockOptions" [value]="cat.value">
                  {{ cat.label }}
                </option>
              </select>
            </div>
          </div>

          <!-- Description -->
          <div class="mb-4">
            <label for="description" class="form-label">Descripción</label>
            <textarea class="form-control" id="description" name="description" [(ngModel)]="product.description"
              rows="4" placeholder="Describe las características principales del producto..."></textarea>
          </div>

          <!-- Action Buttons -->
          <div class="d-flex gap-2 mt-4">
            <button type="submit" class="btn btn-primary flex-grow-1">
              <i class="bi bi-check-circle me-2"></i>
              {{ productData ? 'Guardar Cambios' : 'Crear Producto' }}
            </button>
            <button type="button" class="btn btn-outline-secondary" (click)="resetForm()">
              <i class="bi bi-arrow-clockwise"></i> Limpiar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</form>
